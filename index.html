<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Frog Clicker: Merge Mansion</title>
    <style>
        :root { --grass: #7cfc00; --wood: #5d4037; --ui: rgba(0,0,0,0.9); --machine: #e74c3c; }
        body { margin: 0; padding: 0; font-family: 'Courier New', monospace; background: #2c3e50; color: white; overflow: hidden; touch-action: none; }

        .screen { position: absolute; width: 100vw; height: 100vh; display: none; flex-direction: column; align-items: center; justify-content: center; }
        #title-screen { display: flex; background: linear-gradient(#4facfe, #00f2fe); z-index: 100; }
        #game-screen { background: var(--grass); background-image: radial-gradient(#2ecc71 15%, transparent 15%); background-size: 40px 40px; }

        /* Merge-maskin */
        #merge-zone {
            position: absolute; left: 60%; top: 50%; transform: translate(-50%, -50%);
            width: 250px; height: 250px; border: 6px solid var(--machine); border-radius: 20px;
            background: rgba(231, 76, 60, 0.2); display: flex; align-items: center; justify-content: center; z-index: 1;
        }
        #merge-zone::after { content: "MERGE MACHINE"; color: var(--machine); font-weight: bold; position: absolute; bottom: -30px; }

        /* Frosken */
        .frog-container {
            position: absolute; width: 120px; height: 120px;
            display: flex; align-items: center; justify-content: center;
            font-size: 80px; z-index: 10; cursor: grab;
            transition: transform 0.1s;
        }
        .frog-lvl { position: absolute; bottom: 0; right: 0; font-size: 20px; background: black; color: gold; padding: 2px 6px; border-radius: 5px; pointer-events: none; }

        /* Sidebar og UI */
        #sidebar { position: absolute; left: 0; top: 0; width: 250px; height: 100%; background: var(--ui); border-right: 4px solid var(--wood); z-index: 50; display: flex; flex-direction: column; }
        .tabs { display: flex; background: var(--wood); }
        .tab-btn { flex: 1; padding: 15px; border: none; color: white; background: #3e2723; }
        .tab-btn.active { background: #8d6e63; }
        .tab-content { flex: 1; overflow-y: auto; padding: 15px; display: none; }
        .tab-content.active { display: block; }
        #stats { position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 40px; font-size: 24px; z-index: 60; }
        .shop-card { background: #444; padding: 12px; margin-bottom: 8px; border-radius: 8px; border-left: 5px solid #f1c40f; }
        .log-item { padding: 5px; color: #888; }
        .unlocked { color: #2ecc71; font-weight: bold; }
    </style>
</head>
<body>

    <div id="title-screen" class="screen">
        <h1>FROG CLICKER</h1>
        <button style="padding: 20px; font-size: 20px;" onclick="startGame()">START</button>
    </div>

    <div id="game-screen" class="screen">
        <div id="stats">Clicks: <span id="count">0</span></div>
        <div id="merge-zone"></div>

        <div id="sidebar">
            <div class="tabs">
                <button class="tab-btn active" onclick="openTab(event, 'shop')">SHOP</button>
                <button class="tab-btn" onclick="openTab(event, 'log')">LOG</button>
            </div>
            <div id="shop" class="tab-content active">
                <div class="shop-card" onclick="buyFrog('Green Frog', 0)">Green Frog (Gratis)</div>
                <div class="shop-card" onclick="buyFrog('Blue Frog', 50)">Blue Frog (50)</div>
                <div class="shop-card" onclick="buyFrog('Fire Frog', 200)">Fire Frog (200)</div>
            </div>
            <div id="log" class="tab-content">
                <div id="log-list"></div>
            </div>
        </div>

        <div id="world"></div>
    </div>

<script>
    let state = { clicks: 0, frogs: [], unlockedSpecies: new Set() };
    let draggedFrog = null;

    function startGame() {
        document.getElementById('title-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'block';
        if (state.frogs.length === 0) buyFrog('Green Frog', 0);
        updateLog();
    }

    function buyFrog(species, cost) {
        if (state.clicks >= cost) {
            state.clicks -= cost;
            const frog = { id: Math.random(), species, x: 55, y: 45, level: 1 };
            state.frogs.push(frog);
            state.unlockedSpecies.add(species);
            renderWorld();
            updateUI();
            updateLog();
        }
    }

    function renderWorld() {
        const world = document.getElementById('world');
        world.innerHTML = '';
        state.frogs.forEach(frog => {
            const div = document.createElement('div');
            div.className = 'frog-container';
            div.style.left = frog.x + '%';
            div.style.top = frog.y + '%';
            div.innerHTML = `üê∏<div class="frog-lvl">Lvl ${frog.level}</div>`;

            // Touch-styring for iPad
            div.ontouchstart = (e) => startDrag(e, frog, div);
            div.ontouchmove = (e) => doDrag(e);
            div.ontouchend = (e) => endDrag(e, frog, div);

            // Klikk for poeng (kun hvis vi ikke drar)
            div.onclick = () => { if(!draggedFrog) { state.clicks += frog.level; updateUI(); } };

            world.appendChild(div);
        });
    }

    function startDrag(e, frog, el) {
        draggedFrog = { frog, el };
        el.style.zIndex = 1000;
        el.style.transition = "none";
    }

    function doDrag(e) {
        if (!draggedFrog) return;
        const touch = e.touches[0];
        const xPercent = (touch.clientX / window.innerWidth) * 100;
        const yPercent = (touch.clientY / window.innerHeight) * 100;
        
        draggedFrog.el.style.left = (xPercent - 5) + '%';
        draggedFrog.el.style.top = (yPercent - 5) + '%';
    }

    function endDrag(e, frog, el) {
        if (!draggedFrog) return;
        
        const rect = el.getBoundingClientRect();
        const machine = document.getElementById('merge-zone').getBoundingClientRect();
        
        // Sjekk om sluppet i maskinen
        const inMachine = (rect.left < machine.right && rect.right > machine.left &&
                           rect.top < machine.bottom && rect.bottom > machine.top);

        if (inMachine) {
            // Sjekk om det er en annen lik frosk i maskinen
            const match = state.frogs.find(f => 
                f.id !== frog.id && 
                f.species === frog.species && 
                f.level === frog.level &&
                isInsideMachine(f)
            );

            if (match) {
                // MERGE!
                state.frogs = state.frogs.filter(f => f.id !== frog.id && f.id !== match.id);
                const upgraded = { ...frog, level: frog.level + 1, id: Math.random(), x: 60, y: 50 };
                state.frogs.push(upgraded);
                alert("MERGED! Du har n√• en Level " + upgraded.level + " frosk!");
            } else {
                // Lagre ny posisjon i maskinen
                frog.x = (rect.left / window.innerWidth) * 100;
                frog.y = (rect.top / window.innerHeight) * 100;
            }
        } else {
            // Flytt frosken til der den ble sluppet
            frog.x = (rect.left / window.innerWidth) * 100;
            frog.y = (rect.top / window.innerHeight) * 100;
        }

        draggedFrog = null;
        el.style.zIndex = 10;
        el.style.transition = "left 0.6s, top 0.6s";
        renderWorld();
    }

    function isInsideMachine(frog) {
        // Enkel sjekk for √• se om frosken er i n√¶rheten av maskin-senteret
        return (frog.x > 50 && frog.x < 75 && frog.y > 40 && frog.y < 65);
    }

    function updateLog() {
        const list = document.getElementById('log-list');
        const species = ['Green Frog', 'Blue Frog', 'Fire Frog'];
        list.innerHTML = '';
        species.forEach(s => {
            const div = document.createElement('div');
            div.className = 'log-item' + (state.unlockedSpecies.has(s) ? ' unlocked' : '');
            div.innerText = state.unlockedSpecies.has(s) ? "‚úì " + s : "? Ukjent";
            list.appendChild(div);
        });
    }

    function updateUI() { document.getElementById('count').innerText = Math.floor(state.clicks); }
    function openTab(evt, name) {
        const contents = document.getElementsByClassName("tab-content");
        for (let c of contents) c.style.display = "none";
        document.getElementById(name).style.display = "block";
    }
</script>
</body>
</html>
       
